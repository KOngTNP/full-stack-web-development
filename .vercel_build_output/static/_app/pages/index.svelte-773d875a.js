import{S as K,i as z,s as G,e as k,k as O,c as j,a as E,n as I,d as b,b as a,J as Q,f as C,H as m,K as B,L as H,I as W,M as Z,j as $,m as ee,o as te,x as S,u as V,v as oe,t as se,N as ae,g as le,w as ne,O as re,r as ue}from"../chunks/vendor-7bb50186.js";const L=(o,{result:e})=>{const s=async t=>{t.preventDefault();try{const l=new FormData(o),i=await fetch(o.action,{method:o.method,headers:{accept:"application/json"},body:l});i.ok?e(i,o):console.error("Fetch error: ",await i.text())}catch(l){console.error("Could not submit the form: ",l)}};return o.addEventListener("submit",s),{destroy(){o.removeEventListener("submit",s)}}};function de(o){let e,s,t,l,i,d,c,f,T,y,p,w,R,u,D,n,h,r,g,U,N,M,q,A;return{c(){e=k("div"),s=k("form"),t=k("input"),i=O(),d=k("button"),y=O(),p=k("form"),w=k("input"),u=O(),D=k("button"),r=O(),g=k("form"),U=k("button"),this.h()},l(v){e=j(v,"DIV",{class:!0});var _=E(e);s=j(_,"FORM",{action:!0,method:!0});var F=E(s);t=j(F,"INPUT",{type:!0,name:!0,class:!0}),i=I(F),d=j(F,"BUTTON",{"aria-label":!0,class:!0}),E(d).forEach(b),F.forEach(b),y=I(_),p=j(_,"FORM",{action:!0,method:!0,class:!0});var x=E(p);w=j(x,"INPUT",{type:!0,name:!0,class:!0}),u=I(x),D=j(x,"BUTTON",{"aria-label":!0,class:!0}),E(D).forEach(b),x.forEach(b),r=I(_),g=j(_,"FORM",{action:!0,method:!0});var J=E(g);U=j(J,"BUTTON",{"aria-label":!0,class:!0}),E(U).forEach(b),J.forEach(b),_.forEach(b),this.h()},h(){a(t,"type","hidden"),a(t,"name","done"),t.value=l=o[0].done?"":"true",a(t,"class","svelte-1gx9ska"),a(d,"aria-label",c="Mark todo as "+(o[0].done?"not done":"done")),a(d,"class","toggle svelte-1gx9ska"),a(s,"action",f="/todos/"+o[0].uid+".json?_method=patch"),a(s,"method","post"),a(w,"type","text"),a(w,"name","text"),w.value=R=o[0].text,a(w,"class","svelte-1gx9ska"),a(D,"aria-label","Save todo"),a(D,"class","save svelte-1gx9ska"),a(p,"action",n="/todos/"+o[0].uid+".json?_method=patch"),a(p,"method","post"),a(p,"class","text svelte-1gx9ska"),a(U,"aria-label","Delete todo"),a(U,"class","delete svelte-1gx9ska"),a(g,"action",N="/todos/"+o[0].uid+".json?_method=delete"),a(g,"method","post"),a(e,"class","todo svelte-1gx9ska"),Q(e,"done",o[0].done)},m(v,_){C(v,e,_),m(e,s),m(s,t),m(s,i),m(s,d),m(e,y),m(e,p),m(p,w),m(p,u),m(p,D),m(e,r),m(e,g),m(g,U),q||(A=[B(T=L.call(null,s,{result:o[2]})),B(h=L.call(null,p,{result:o[2]})),B(M=L.call(null,g,{result:o[1]}))],q=!0)},p(v,[_]){_&1&&l!==(l=v[0].done?"":"true")&&(t.value=l),_&1&&c!==(c="Mark todo as "+(v[0].done?"not done":"done"))&&a(d,"aria-label",c),_&1&&f!==(f="/todos/"+v[0].uid+".json?_method=patch")&&a(s,"action",f),T&&H(T.update)&&_&4&&T.update.call(null,{result:v[2]}),_&1&&R!==(R=v[0].text)&&w.value!==R&&(w.value=R),_&1&&n!==(n="/todos/"+v[0].uid+".json?_method=patch")&&a(p,"action",n),h&&H(h.update)&&_&4&&h.update.call(null,{result:v[2]}),_&1&&N!==(N="/todos/"+v[0].uid+".json?_method=delete")&&a(g,"action",N),M&&H(M.update)&&_&2&&M.update.call(null,{result:v[1]}),_&1&&Q(e,"done",v[0].done)},i:W,o:W,d(v){v&&b(e),q=!1,Z(A)}}}function ce(o,e,s){let{todo:t}=e,{processDeletedTodoResult:l}=e,{processUpdatedTodoResult:i}=e;return o.$$set=d=>{"todo"in d&&s(0,t=d.todo),"processDeletedTodoResult"in d&&s(1,l=d.processDeletedTodoResult),"processUpdatedTodoResult"in d&&s(2,i=d.processUpdatedTodoResult)},[t,l,i]}class ie extends K{constructor(e){super();z(this,e,ce,de,G,{todo:0,processDeletedTodoResult:1,processUpdatedTodoResult:2})}}function X(o,e,s){const t=o.slice();return t[4]=e[s],t}function Y(o){let e,s;function t(){return o[3](o[4])}return e=new ie({props:{todo:o[4],processDeletedTodoResult:t,processUpdatedTodoResult:o[2]}}),{c(){$(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,i){te(e,l,i),s=!0},p(l,i){o=l;const d={};i&1&&(d.todo=o[4]),i&1&&(d.processDeletedTodoResult=t),e.$set(d)},i(l){s||(S(e.$$.fragment,l),s=!0)},o(l){V(e.$$.fragment,l),s=!1},d(l){oe(e,l)}}}function fe(o){let e,s,t,l,i,d,c,f,T,y,p,w;document.title=e=P;let R=o[0],u=[];for(let n=0;n<R.length;n+=1)u[n]=Y(X(o,R,n));const D=n=>V(u[n],1,1,()=>{u[n]=null});return{c(){s=O(),t=k("div"),l=k("h1"),i=se(P),d=O(),c=k("form"),f=k("input"),T=O();for(let n=0;n<u.length;n+=1)u[n].c();this.h()},l(n){ae('[data-svelte="svelte-53v0d5"]',document.head).forEach(b),s=I(n),t=j(n,"DIV",{class:!0});var r=E(t);l=j(r,"H1",{});var g=E(l);i=le(g,P),g.forEach(b),d=I(r),c=j(r,"FORM",{action:!0,method:!0,class:!0});var U=E(c);f=j(U,"INPUT",{type:!0,name:!0,"aria-label":!0,placeholder:!0,class:!0}),U.forEach(b),T=I(r);for(let N=0;N<u.length;N+=1)u[N].l(r);r.forEach(b),this.h()},h(){a(f,"type","text"),a(f,"name","text"),a(f,"aria-label","Add a todo"),a(f,"placeholder","+ type to add a todo"),a(f,"class","svelte-7x7x6"),a(c,"action","/todos.json"),a(c,"method","post"),a(c,"class","new svelte-7x7x6"),a(t,"class","todos svelte-7x7x6")},m(n,h){C(n,s,h),C(n,t,h),m(t,l),m(l,i),m(t,d),m(t,c),m(c,f),m(t,T);for(let r=0;r<u.length;r+=1)u[r].m(t,null);y=!0,p||(w=B(L.call(null,c,{result:o[1]})),p=!0)},p(n,[h]){if((!y||h&0)&&e!==(e=P)&&(document.title=e),h&5){R=n[0];let r;for(r=0;r<R.length;r+=1){const g=X(n,R,r);u[r]?(u[r].p(g,h),S(u[r],1)):(u[r]=Y(g),u[r].c(),S(u[r],1),u[r].m(t,null))}for(ue(),r=R.length;r<u.length;r+=1)D(r);ne()}},i(n){if(!y){for(let h=0;h<R.length;h+=1)S(u[h]);y=!0}},o(n){u=u.filter(Boolean);for(let h=0;h<u.length;h+=1)V(u[h]);y=!1},d(n){n&&b(s),n&&b(t),re(u,n),p=!1,w()}}}const me=async({fetch:o})=>{const e=await o("/todos.json");if(e.ok)return{props:{todos:await e.json()}};const{message:s}=await e.json();return{error:new Error(s)}},P="Todo";function he(o,e,s){let{todos:t}=e;const l=async(c,f)=>{const T=await c.json();s(0,t=[...t,T]),f.reset()},i=async c=>{const f=await c.json();s(0,t=t.map(T=>T.uid===f.uid?f:T))},d=c=>{s(0,t=t.filter(f=>f.uid!==c.uid))};return o.$$set=c=>{"todos"in c&&s(0,t=c.todos)},[t,l,i,d]}class pe extends K{constructor(e){super();z(this,e,he,fe,G,{todos:0})}}export{pe as default,me as load};
